function [Y,Xf,Af] = decodingModel_01(X,~,~)
%DECODINGMODEL_01 neural network simulation function.
%
% Auto-generated by MATLAB
% 
% [Y] = decodingModel_01(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 122xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1.gain = [2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1350186375303510378;1.1573311586239232174;-0.29113447522101543186;0.29871511435299974435;-1.0990136546659878825;3.5631368707705566301;3.8398188926560439249;-1.0222537628549173139];
IW1_1 = [-0.29627650013820294728 0.51354521484730608627 -0.16648643990296316253 0.49450017375202626191 -0.12396397268300712868 0.38438329088243911036 -0.32283506276604273522 0.48705531801668755509 -0.2683954732904121343 0.60692186648503765323 -0.0049238093655424542902 0.40941351044685780902 -0.088176557599121574427 0.61265438046345677137 -0.21069202672553918876 0.4050525280767244829 -0.19143535253807142382 0.41132842358110399683 -0.14160657623072644973 0.33099685191235267423 -0.023066551721076071491 0.40895578087711131898 0.044928241507225387397 0.39697998101756409861 0.044176600279890405887 0.24562772928846732245 -0.27582840940317676637 0.20634044848285765239 -0.16670217704571141382 0.24094867896237345817 0.066951475093981416276 0.13491308839370771966 0.098933197358713559355 0.22711300714717486127 0.13116351351984842366 0.23383783387568687906 0.065535537687381156813 0.20942009238578609964 0.15018389176506308225 0.16607183614017975715 0.070563546966062026811 0.021172546153099495309 -0.0041823253166206157683 0.049607912914311116936 0.1618826586139542334 0.0022302365118003326071 -0.094975232626887604037 0.0028673662057466437793 0.10962628037424486382 -0.1392442773367273956 0.19809180436265944047 -0.090040136181805063842 0.30570424960511916046 -0.1815543734411343979 0.21263932283843198223 -0.15959811914039589986 0.010428983810444127783 -0.064770864948398051975 0.10738107482902480017 -0.23884309140102710778 0.20487332080099598941 -0.18805986464468860131 0.30109791189655138455 -0.33430887409020304535 0.16051828424073227852 -0.29868728846836040125 0.15955146603179456988 -0.17566179489812924763 0.11568197669637066138 -0.43632526973181245955 0.064866083458634898884 -0.36609696712449246725 -0.065476719438492411718 -0.32431972982307111231 0.19994891192733191265 -0.43877335210594198278 0.066267183038036928111 -0.20513260628083082593 0.050377692286496890406 -0.28494430071051407571 -0.0043364958045734140757 -0.23587250008275881252 -0.14948008771651241644 -0.16743109663081517935 -0.077126644754018203187 -0.38645278648482989103 0.087571213965100966337 -0.27717447006525541831 -0.19472379096559583322 -0.33838853144159153352 0.013105300524618026387 -0.32358680385035981653 -0.041255475962383027222 -0.29380441664611328667 -0.20324619952670325285 -0.19548386456979588433 -0.34236676595775439313 -0.14069084587120500585 -0.085016928936602231826 -0.13445311453549960157 -0.14007806031184324991 -0.20310412569894675805 -0.16476636703207481194 -0.20156389223437021219 -0.34012512569830238851 -0.15760906387552775509 0.11455922147141048284 -0.24251875422031907159 -0.22727460942140587097 -0.21769837232276145755 -0.057589158571879961457 -0.34518859806238050281 -0.27928701625640917072 -0.22490321248613076577 -0.15682415787509704219 -0.18190287974197777432 -0.017600581189397130483 -0.069953352114433348108 -0.21863457090806895367 0.0028258599602695305686 -0.11847668572943342857 -0.22684486299102163409;-0.079648870649326714011 0.32389986544530291468 0.10353745047195876683 -0.016111489569738762784 -0.087465317321023194896 0.058063233866984170772 0.066251103951435463824 -0.082426755244637259223 0.11064379260488919898 -0.20126419783583193723 0.15842057369797646338 -0.076206407540197099171 0.068140876199193178842 -0.17121636035398118958 0.1872691618411761183 -0.10401684786948325878 0.068282185577705503676 0.074557952319925360762 0.042304112818894866466 0.044543687154598873845 -0.0066802398887250780471 -0.10875089171800948751 0.069173220282153807803 0.066666682231136933923 0.15768472042776035535 -0.11161897370617353265 0.022636960716256017412 -0.019340590930794716862 0.071347457298495703393 -0.040296565835488969143 -0.074932914153625490572 0.20479948065513972622 0.093996814465252154225 0.1713795489719062981 -0.051515140642979954932 0.055879525191517766258 -0.14864278825780014026 -0.00064784542954195905098 0.08934410178863072538 -0.04792208243909239912 0.2885560642320726954 0.023030973574183707248 -0.061335593647741035173 -0.19368291359861269929 -0.10920727502239546691 -0.13787672304589113081 0.13075092337764396277 -0.022124693804720152457 -0.14244263928812458952 -0.18140966871100830393 0.18009929661724352612 -0.15811552136748624475 -0.017592910869210644231 -0.12369748289756228588 -0.030810502314294205273 -0.15288861316092997034 0.096212937890861618961 0.048027544359693662146 -0.17760775209290430299 -0.25919655265417229639 0.17213796675768669453 -0.07024287093889607092 0.14098705365040811732 0.25210465434638795745 0.22160928234725407737 0.30193763986805166599 -0.092991228315544099958 -0.087931873814924274568 0.072095997922760779453 -0.0054819757183347059964 -0.11219795156555685545 -0.058131655373736261516 -0.14856365540345184417 0.098501995801645092499 0.055432062566921708191 -0.09942363148199809264 0.0078232637131385868168 -0.020554657923245314016 -0.0023442596863747517527 -0.23386674846908483971 -0.00056114765825450094172 -0.049590598760671608658 0.12246012526840419077 -0.002402805690429602424 0.1341820581476772245 -0.15240970995029612389 -0.10357498850668281354 -0.12135727656869572944 0.076851622690665727378 -0.069365485484768646396 0.28267373390362915409 -0.12082038826991187142 -0.099024876918090906641 -0.06427925181622774764 0.055119905651669479085 0.156728449801799119 0.018153305195208933875 0.032889147114089738178 -0.11322215486832150344 -0.18483515125809060753 0.1503352470110040362 -0.14450696572955645802 -0.031001875774716580736 0.14047203304132971358 0.11522239865074189458 -0.037071712821639006552 -0.152400203101887316 0.18106780098934660561 -0.019825207618007829879 -0.12526097685981701924 0.05500285325975590861 0.22582875256402182296 0.17085496228152446951 -0.29322207525449278664 0.32592902370436432902 0.10423136893492404575 0.010964742801544665254 -0.080924883552778353879 -0.10710677035960745884 -0.053428141748789244325 -0.053654609694459114155 0.021577730629135101481;0.26392955990224359342 -0.26474395865575173215 -0.27084598613305593817 0.12310646809232694832 0.23324289950045085096 0.11630108124755300647 -0.027681863465074414005 0.20015003561360583673 -0.18078748413516396165 0.14398808317604724905 -0.14702135422193254866 -0.19647402698250318598 0.07200874205139826123 0.2132300694644231609 0.12918558467865823292 0.09416704215812128631 -0.20835416953245133875 0.19971353445299147578 -0.10317202267293643092 -0.01784995343056522063 0.077738648884453129262 -0.031504530283669451851 -0.14559112070560811802 -0.069645942089717305379 0.10670215640519163658 0.2887885582158731812 -0.082924376188974732726 0.039322947649826744954 -0.27410571696691882204 0.14680854740876300712 0.11527602380548281069 -0.38665606550637848793 -0.20195708054339603366 0.36494042246167851529 0.24280740037747425286 -0.029523460859099261849 -0.18834457524599479417 0.019082029009859516333 0.16157843068889748972 -0.087537756956565668243 -0.076364061791741794094 0.31793789539587385962 0.0755032099085874292 0.070221045175133264826 0.15311944680609360092 -0.10603696129719687724 -0.11854008336254184819 -0.11907109869955020964 -0.10535846451080528585 0.1108893393181438064 -0.00074592806388950217301 0.023183977185353577682 0.06288773609516892793 -0.082393196991242589888 -0.20288281532285049047 0.044111862804078583178 -0.19016140397969075182 0.099475948589125062771 0.23165812542450897604 0.015539273294723104576 -0.1162971630682737012 -0.032629219728017265501 -0.16761036124950412507 0.31682960709423352297 0.31094614687088151239 -0.087144069985178401749 -0.12991165670411486399 0.25130766670605275692 0.0465923253208254326 -0.074524200272689411495 0.1978219724687755865 0.24472693187703567497 0.065911421103449746584 0.1033701675182494284 -0.068136251976734257818 -0.072701551548216725163 0.26802718749133125353 0.12733183597546618437 0.17103013076208911647 -0.17233023807670386218 -0.13015450012421697634 -0.016376760021478285051 0.39957483873917404305 0.22967614470062214238 0.092115070093221326775 0.17960370762026239833 0.29675246647410585821 -0.16488864622012411321 0.16946796886115955694 -0.032213229823278032027 0.049018915827072850888 -0.085396004535635713917 0.18765040377193212273 -0.074898683530332813008 0.13918484528189992155 -0.0062939544386516957375 0.29081825675503791828 0.14735052277733876047 0.12366117722889655162 -0.016957282073090367697 -0.019472557456741045739 -0.00048268219367000192183 -0.011799632993390755942 0.14205562191097936831 0.081960012446964283783 0.23597379070920426747 -0.072411490383166701723 -0.12831646947081512544 0.056228098815720786718 -0.13627602562141388765 0.26178239738123043612 -0.089479427904889441425 0.12647668257382102541 -0.0066987551654953359989 0.077402447395546414288 -0.25558206778550857097 0.036082536987014628138 -0.15688058818431627195 -0.037900549725085497244 0.089311285548918956101 -0.2120393714005192054 -0.0029654961634471748225;0.05162540218981721829 -0.38104540323335822638 0.022147933379951245669 -0.23133105006274190529 0.26246866602590984696 -0.33387965327177226982 0.29408033225800034316 -0.15712508101903974178 0.25031518227607624238 -0.36865452654263902721 0.31003516144358467255 -0.43804710818465120159 0.19863007656430561876 -0.29105099732770089993 0.24512565563863086826 -0.25980269085890334013 0.32379868184765481232 -0.26173414067179157083 0.28654744299381973427 -0.41698888315833837481 0.088905803051548853988 -0.28228518547831599195 0.28359842563582793318 -0.32036105098341149944 0.25648787498630859494 -0.37423909074403050035 0.36576367039539731119 -0.37828468818448884869 0.3523362289198707642 -0.36181828860165654582 -0.094559059074061022065 -0.44853252257676484716 0.21395055285168432246 -0.32999032626008290014 0.099269779954476333739 -0.26709551173188850193 -0.052396701734829902175 -0.36007024982159480109 0.28901721647004252613 -0.36593964875630236033 -0.021559869670770458877 -0.36384820436220249862 -0.05193410639596402617 -0.26420617757311587459 -0.070241992513668721765 -0.30491676948014401205 0.042197072820846386054 -0.21641123513436236192 -0.10936892885558220645 -0.22558370300775090755 0.15986665006206135509 -0.23883933672937529558 0.072850180413260703927 -0.22392650388250709415 0.03519474236137638129 -0.21131444003824306765 -0.10409885702080694247 -0.15434455777515515562 0.075722617450488208246 -0.11597818724972003279 0.10697951244489142808 -0.27093922629199768126 0.028359192528235353109 -0.18905134233728623783 -0.17471211234320180306 -0.16281716461104753235 -0.073930558140014979163 -0.13978889148614800919 -0.20119265066482913684 -0.16388503572763257754 -0.26169787071641165133 0.15517596207874392866 -0.21277672802731423252 0.15930651517428590092 -0.21785770177242533285 -0.00081059098337635574448 -0.2628539869489212033 0.11508811515040313911 -0.28195100440326020808 0.14880344958951982615 -0.20921383960945547087 0.11917481739556450016 -0.3048999068711848448 0.17721599540292429231 -0.23080221731878330926 0.21133903407527554474 -0.27543391734562555628 0.23085526177059262354 -0.42381418528471781482 0.18605669202443900212 -0.3816356552514265088 0.17546643040062070984 -0.19730781039081254913 0.15169327007855923362 -0.18413975834856213809 0.18682351749464420898 -0.34671934006137195006 0.31015152060939144008 -0.12842523508268660626 0.48517910627668997536 -0.1683745293510475749 0.35407754179319556043 -0.32845669127145304955 0.4312020389230723505 -0.13418078493722579436 0.40697013175315793765 -0.18140103987581512879 0.41151447563336429614 -0.14816932700288176772 0.38742909278236936643 -0.18176651619964179218 0.30462614147451477775 -0.036633239972737222101 0.30693229149633094455 -0.17864133408961996308 0.31873360867002759056 -0.14545884117326762786 0.26285966086833573163 -0.077120088098262179477 0.33491377048142345618 -0.060420880316639329066 0.25266770274982724986;0.056597852870737111464 -0.070806566866600778587 0.3392935167224339077 -0.054761348232987762386 0.30322320238351629929 -0.19978506855187541658 0.16786876748282755778 -0.099133485032142823479 0.30203956342277865632 0.037774569548326725199 0.39565597559090587287 -0.027562358520011164681 0.18574414112094941864 0.11907317383294166446 0.50559106145297605384 -0.031220905386448324914 0.25390087419943591085 0.079310310288572646864 0.51534156926924701292 0.067037682709567336659 0.37421720613056341787 -0.02393240417284406979 0.56865703101189446489 0.089805515646663322538 0.29408921906206381136 0.19780871524426649199 0.10736875321537962813 0.066371281046003788306 0.21857761191203434192 0.34935593300260925353 0.044054649619380083225 0.047059252473455853716 0.21239693596136338671 0.018017907037927029246 0.053006991319209856295 0.077848875454889596148 0.093393215250982417053 0.0061390885927772691211 0.32596004131047301433 0.12808467731786635224 0.0093232668877929400497 0.22097545257965586774 -0.026090493552029303537 0.0034159128324299597133 0.1053204050352642418 -0.031604341468776345203 -0.16958281438844616251 -0.046621685412157651274 0.021777672428677511546 -0.1513894036184929015 -0.036948370297971676324 -0.17108423204629422121 -0.048608083113954356214 -0.05776185325378217772 0.009868385499797571736 -0.069370152413056065943 -0.0038087165847793965322 -0.066466831511345303429 -0.0038647207918740007077 -0.084849466652791583066 0.093280194612403402599 -0.096219703920523508289 -0.030773756121560455479 -0.038163133880289933086 -0.1275580277950830177 0.042541803774416603323 -0.32847066366136573601 -0.043478012478002925345 -0.15592244335331437166 -0.054095953186994900908 -0.070306370640782364645 -0.022871560275469701717 -0.28782763041217696021 0.086626513609754596246 -0.31413364468298055066 -0.0064521244432853858825 -0.35205188649411478519 -0.11048747566112945839 -0.31028372315329910691 -0.19270006813492648878 -0.25550334386020967514 0.019788572343860836439 -0.24068720171429491828 -0.10429262766054153699 -0.20664397097425948879 -0.14461033738196346632 -0.054943732964167914246 -0.092957970639291842563 -0.16258082228533166091 -0.050051964206878692132 -0.21856984542445592745 0.028143614154983051523 -0.0874330940843562332 -0.15309375258348273396 -0.082744812125592689944 -0.105841933969887253 -0.35692472604236258338 -0.031477197715232399511 -0.5466485951080047867 -0.025289741458463799173 -0.38056330336130345104 0.082714275054701399958 -0.3237911498154228962 -0.060619223754745772681 -0.43460276437685152473 -0.20467851583213017563 -0.56438662760029423282 -0.12929753852637967948 -0.26475557402273858232 -0.13685601785066572877 -0.53203006985247314198 -0.1394601502679208016 -0.22344177433349363127 -0.02190240186978408346 -0.47732984864442457029 -0.12695537375191723317 -0.57671861622843878514 -0.073297298543771524648 -0.46903429983360994671 0.015101230251046669772 -0.49822051656207722026 -0.085008129764722606403;0.072937150308420128919 0.071847361776369023101 0.11022263845458041276 0.085337791047312094861 0.088728024310402608954 0.073072984406109417477 0.11396256541979350729 0.12839538894954696802 0.11062661266910475688 0.10588534226243688507 0.16959769821952452862 0.11301087156329092664 0.14447688505493952449 0.14056950551400870797 0.15882131175258110134 0.1152006638514275344 0.1481259918573009926 0.10581141190138836083 0.13431355146187112792 0.1277895244426496546 0.13909004906770588983 0.14890936019170208926 0.19180846733542036842 0.12035619616932240195 0.14947434086218694405 0.10981166205971974736 0.1290049549174708543 0.10250126353865685047 0.16534788899153582409 0.10657880750107219525 0.092009432034728916294 0.10601826610445520827 0.15485343504224768907 0.10001192713687737101 0.12593719608181158653 0.12680163729627041969 0.10422669345326916746 0.099984173469011949908 0.15288730712912135257 0.12824396337036986226 0.062592333368889710443 0.070724616934558504067 0.068418619351342135904 0.10351747098319612206 0.061264300348700756471 0.092387522069753133525 0.012769874368723760361 0.087482722553829300738 0.028900493921101833017 0.087897130158458500193 0.077887783718438380332 0.086932340127696947074 0.027102527097055777866 0.10234423095075007026 0.048730453225627655411 0.12192998874015396893 0.03190024233776148771 0.088168034095913921933 0.010452785181242922607 0.08756593873589242627 0.025677623011395870473 0.052098635335468747309 0.054058353251926337391 0.021563205731543095417 -0.0029528345685566805695 0.061775278336417493996 -0.0064247158326802902839 0.037516528516025805795 -0.027686517350233447177 0.0280995788871721483 -0.038352145988952167366 0.090631893444920300085 -0.067849147089440342562 0.060564199694595997892 -0.0058166122657866267329 0.028269392676717627205 -0.018444374286878922886 0.050583549326394791623 -0.063985619895699438753 0.051052537375476859938 -0.035859790627747224756 0.032391166421711206636 -0.094667138298912809069 0.048710961666182280017 -0.026030436170205294849 0.018477558424956425781 -0.013334013550227502912 0.044316344656050596362 -0.081890597454312819004 0.036042017154228965514 -0.030475052682945272253 0.051748997334894457356 -0.00053128296849877510149 0.042857163138327755703 -0.00042918552103643806649 0.034591352729089981655 -0.064231601196991533476 0.095035284540778919293 0.028759731460712575912 0.083940733646904672205 0.019123080399269885149 0.049800702134847711633 0.016754871667608327301 0.080403171018042479679 -0.022589947684457559185 0.021948914468808335826 0.043985327123336449839 0.046870706899237307708 -0.022749610404353675513 0.025408359394479149151 -0.0012060623639116245086 0.011237755358899264788 0.046245259015277186132 0.010870611044454546457 -0.0087981874983223615216 0.019251649300571892914 0.00222385910417175316 0.018250676301465044299 -0.012733960216522113504 0.040699005042697564138 -0.014067835976183910504 -0.0051361917865480593431;0.066279200119525705226 0.080561354106225335769 0.1226880657306584077 0.092411627376158350655 0.091764782455290266894 0.08815278505254742214 0.10881949338707190555 0.080518012671450020501 0.11297438874715039214 0.088302549746302638756 0.14052137319951649164 0.10010098196672850834 0.10934621048708588475 0.083330296092563260757 0.15723062248673744246 0.01312386743350179609 0.12119288324447537175 0.037178700852506241237 0.18416105054308284927 0.069901131255549364685 0.10805432119190358509 0.017757685132726356431 0.18054752098234183588 0.033138202041909599338 0.14634800582626053544 0.068016439455925142843 0.16657038975077700926 0.066901483212891132979 0.17549818071733591651 0.073933169058011921626 0.15490605530252316013 0.064456961783475180683 0.17367218944885837173 -0.021209009559211785406 0.10311612983108159325 0.018657573325009935844 0.174075516045019002 0.014282259967652919871 0.17214350951600893014 0.03823442491980644925 0.12963000000543545287 0.037603746951939118204 0.14232979674607496023 0.024069549427304475636 0.1390280826744102749 0.052670303549909640306 0.05754105449191154048 0.016082630244212910847 0.13368008830258487629 0.025598906455298817142 0.10557960341732895715 -0.016642850072394233668 0.1119381305206915006 0.030104986920598715561 0.090379611496153006156 0.025793873622593804784 0.1109250051674819243 0.011300976901032627753 0.09631533332391821467 0.01232501781727056954 0.067970675387853313199 -0.0033851111075183051326 0.068575678351958657686 -0.023995343551759088646 0.074158413091112707072 -0.032374941179455954399 0.035169244834477322859 -0.013507222930987616144 0.058386522467814123971 0.050040278403480617508 0.054137538634956537675 0.028188723537173075717 0.068112702283959547511 0.036618799365394742729 0.061730720311891730534 0.041346719881182672496 0.046529632173171353582 -0.0068435769547364076401 0.069664019894701098568 0.0097886662364461262537 0.057221297662434354725 -0.030780791437834558594 0.076497817272356993801 -0.012552868276048777599 0.080927149050789487505 -0.022407993539213161283 0.15041791059093068128 0.0067024642207552109774 0.1015328211573209849 0.019151486993261284536 0.11867991424553200885 0.024189135964684842922 0.092590879318828672728 -0.0060875408203949236616 0.21003473483987872283 -0.021641993640822407285 0.11695724220537537241 -0.018588659972725653929 0.050591939336127766946 -0.022545551746900354545 0.1000261360369786301 -0.0072482631391265440676 0.10786329809324625428 -0.021308538025636113156 0.064344126118197453312 -0.044797926318336442342 0.04120805053490630282 -0.020715716573657817767 0.069993603781080035442 -0.027811961353235582772 0.12376182706167426772 -0.013271813655044437455 0.16442532692189074095 0.052622006621000826099 0.10173722066198967462 0.012663187972987596103 0.1108909793206682981 0.073887327167043659326 0.12138347436135250856 0.023924479973724523119 0.080833493744677173409 0.038757358343984069093;-0.089115061195229480773 0.24647113700325593011 0.0062584414855141956915 -0.21419789287375529119 -0.34755104760158583854 -0.25028484431472192151 -0.027276554248836269029 -0.099475030602436967375 -0.16157560322668101938 -0.040936403519237662962 -0.47785425823914151611 0.14032327907927086286 -0.233999380201466739 0.074516296152570660194 -0.27885751821093512914 0.19022685009163503578 -0.054601601636336642709 -0.11247287533551769689 -0.45467774293800755636 0.014093240527471712076 0.1771519284014085871 0.091100942795215661407 -0.072828592232706948484 -0.037568571501220976439 -0.34074303666405258983 -0.12099389228222350023 -0.11819642591042478497 -0.26362103000769132599 -0.13694696107058981771 -0.080187083289699742639 -0.13121635333218728547 -0.20990579980227974666 -0.30444225054119583573 -0.1532348474949096484 0.011079408880547335359 -0.16902318749752778815 0.19961800183893671501 -0.27270214618447480293 -0.17317014357594431861 0.0017036536690283991553 0.026000772310415521532 -0.063306471730808694387 -0.033479218547597271172 0.059251194393640113645 0.23447029957864970462 -0.18015818415309348133 0.32798767844871346 -0.066838688411603328077 0.21463924485472998804 -0.23526443112268793922 0.18622720043359744513 -0.20896605690466216187 -0.10675965761812036825 0.025001879513748520578 0.068794966779907901211 0.10285595533142663505 0.079055899033484366978 -0.14788097764224025776 -0.046142890808706392425 0.17018372240978180132 0.16524048712307043418 0.14809472320661704048 0.16696241125521046889 0.059959205402237113203 -0.11192582192599859203 0.099399025705026233801 0.24350150238474418951 -0.10820196739229970273 0.26236889098743088056 -0.21776054810394718242 0.21300124962742314483 -0.20906116786066844537 0.15676278938920873429 0.033783028605115471288 -0.13905965501505940241 -0.065044641751474840952 -0.073826983767479661958 -0.07267507669215367283 -0.063567258325394823681 0.096760542469616531158 0.21549264413614699354 0.22951498838961845173 -0.050689758112570017234 -0.036048320531118900611 0.13809294637906771586 -0.056984718603983040841 0.092887300671799122309 -0.11191090882356635738 0.30229777654287404154 -0.054513676173724441576 -0.047309427506972687172 -0.017189249688734687532 0.23748064074628996711 -0.04654740238367419819 -0.12612103225480364443 -0.16361657670841539547 0.17209092745619383735 -0.13967191546457546902 -0.066891682390764845012 0.095040646441179738035 0.30723987027148091933 -0.033503336734971835009 0.40075761472191490098 -0.042357399381075883094 0.471480376356233577 0.081919351357971390004 0.26915363017303334248 0.06145799370536095263 0.40665301416110788413 0.15363446937232111411 0.0099065983792607104769 0.15163581219832078517 0.087720292554182136002 -0.19056150664348120438 -0.081401230566153615076 0.31974452511452494674 -0.07767240044725712278 0.022107398018226216002 0.055724092425924506844 0.021625522333695492566 0.37735053376935739911 0.22364210753717173041];

% Layer 2
b2 = [-0.36652987388235436228;-0.29207497124026615687;1.46792216276525056];
LW2_1 = [0.90280619638998860221 -0.70478630782725748549 -0.30877077297821708957 0.49373664407879847005 1.7187774127257593459 -2.3970362728577359057 -0.30614686426106524353 -0.63070095248090418671;-1.3044005412112347209 -0.67959178933904573761 0.22391734615361238991 -1.5824507708533384065 1.3133016071296426119 1.8143900155836236721 -2.3979392800276011499 -0.68832624246578255622;-0.046174699412404804355 -0.2908059393646237889 0.8892970874612531329 -0.20809996998143892588 -1.5193067838834219963 1.1644232367087199442 3.7345419200853031683 0.8020681077309099738];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
